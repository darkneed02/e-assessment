<?php
require_once 'vendor/autoload.php';

use PhpOffice\PhpWord\PhpWord;
use PhpOffice\PhpWord\Style\Table;
use PhpOffice\PhpWord\Style\Cell;
use PhpOffice\PhpWord\Style\Font;
use PhpOffice\PhpWord\Style\Paragraph;

// Create a new PHPWord Object
$phpWord = new PhpWord();
$phpWord->setDefaultFontName('TH SarabunPSK');
$phpWord->setDefaultFontSize(12);

// Section 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°
$section1 = $phpWord->addSection();

// Title
$section1->addText(
    "‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó.",
    ['bold' => true, 'size' => 14],
    ['alignment' => 'center']
);

$section1->addText("‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°", ['bold' => true, 'size' => 12]);

// Table Style
$styleTable = [
    'borderSize' => 6, 
    'borderColor' => '000000',
    'cellMargin' => 80,
    'alignment' => 'center'
];
$phpWord->addTableStyle('SurveyTable', $styleTable);
$table = $section1->addTable('SurveyTable');

// Table Headers
$table->addRow();
$table->addCell(6000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ", ['bold' => true], ['alignment' => 'center']);
$table->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô(‡∏Ñ‡∏ô)", ['bold' => true], ['alignment' => 'center']);
$table->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞", ['bold' => true], ['alignment' => 'center']);

// Data Rows
$data1 = [
    [['1. ‡πÄ‡∏û‡∏®','    1.1 ‡∏ä‡∏≤‡∏¢', '    1.2 ‡∏´‡∏ç‡∏¥‡∏á'], ['','6', '4'], ['','60.00', '40.00']],
    [['2. ‡∏≠‡∏≤‡∏¢‡∏∏','    2.1 21 - 40 ‡∏õ‡∏µ', '    2.2 41 - 60 ‡∏õ‡∏µ', '    2.3 60 ‡∏õ‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ'], ['','3', '3', '4'], ['','30.00', '30.00', '40.00']],
    [['3. ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î','    3.1 ‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ', '    3.2 ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ'], ['','5', '5'], ['','50.00', '50.00']],
    [['4. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£', '    4.1 ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£','    4.2 ‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£','    4.3 ‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó','    4.4 ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£','    4.5 ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢','    4.6 ‡∏≠‡∏∑‡πà‡∏ô‡πÜ'],['','2','2','2','2','1','1'],['','20.00','20.00','20.00','20.00','10.00','10.00']],
    [['5. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó.','    5.1 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á','    5.2 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á','    5.3 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á','    5.4 4 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á','    5.5 ‡∏≠‡∏∑‡πà‡∏ô‡πÜ'],['','2','2','2','2','2'],['','20.00','20.00','20.00','20.00','20.00']],
    [['6. ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó.','    6.1 1 ‡∏õ‡∏µ','    6.2 2 ‡∏õ‡∏µ','    6.3 3 ‡∏õ‡∏µ','    6.4 ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 4 ‡∏õ‡∏µ','    6.5 ‡∏≠‡∏∑‡πà‡∏ô‡πÜ'],['','2','2','2','2','2'],['','20.00','20.00','20.00','20.00','20.00']],
    [['7. ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó.‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏Ç‡πâ‡∏≠)','    7.1 ‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠-‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏•‡∏≤‡∏î ‡∏Å‡∏¢‡∏ó.','    7.2 ‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏¢‡∏≤‡∏á‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å ‡∏Å‡∏¢‡∏ó.','    7.3 ‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏¢‡∏≤‡∏á‡∏à‡∏≤‡∏Å ‡∏Å‡∏¢‡∏ó.','    7.4 ‡∏ô‡∏≥‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó. ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå','    7.4 ‡∏ô‡∏≥‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó. ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå','    7.5 ‡∏≠‡∏∑‡πà‡∏ô‡πÜ'],
    ['','2','2','2','2','2'],['','20.00','20.00','20.00','20.00','20.00']]
];

foreach ($data1 as $row) {
    $table->addRow();

    // üü¢ ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏£‡∏Å (‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô) ‡∏à‡∏±‡∏î‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢
    $cell1 = $table->addCell(6000, ['valign' => 'top']);
    $textRun1 = $cell1->addTextRun();
    foreach ($row[0] as $line) {
        $textRun1->addText($line, [], ['alignment' => 'left']);
        $textRun1->addTextBreak();
    }

    // üü¢ ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏≠‡∏á (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô) ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á
    $cell2 = $table->addCell(2000, ['valign' => 'top']);
    $textRun2 = $cell2->addTextRun(['alignment' => 'center']);
    foreach ($row[1] as $line) {
        $textRun2->addText($line, [], ['alignment' => 'center']);
        $textRun2->addTextBreak();
    }

    // üü¢ ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏≤‡∏° (‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞) ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á
    $cell3 = $table->addCell(2000, ['valign' => 'top']);
    $textRun3 = $cell3->addTextRun(['alignment' => 'center']);
    foreach ($row[2] as $line) {
        $textRun3->addText($line, [], ['alignment' => 'center']);
        $textRun3->addTextBreak();
    }
}


// Section 2: ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
$section2 = $phpWord->addSection([
    'orientation' => 'landscape',
]);

$section2->addText(
    "‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà2 ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à / ‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£",
    ['bold' => true, 'size' => 14],
    ['alignment' => 'left']
);

// Table Style
$phpWord->addTableStyle('SurveyTable2', $styleTable);
$table2 = $section2->addTable('SurveyTable2');

// Table Headers
$table2->addRow();
$table2->addCell(4000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])
       ->addText("‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô", ['bold' => true], ['alignment' => 'center']);
$table2->addCell(8000, ['bgColor' => 'D9D9D9', 'gridSpan' => 10, 'valign' => 'center'])
       ->addText("‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à", ['bold' => true], ['alignment' => 'center']);
$table2->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])
       ->addText("‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à", ['bold' => true], ['alignment' => 'center']);
$table2->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])
       ->addText("‡πÅ‡∏õ‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°", ['bold' => true], ['alignment' => 'center']);

// Sub Headers Row 1
$table2->addRow();
$table2->addCell(4000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);
$subHeaders = ['‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å (1)', '‡∏ô‡πâ‡∏≠‡∏¢ (2)', '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (3)', '‡∏°‡∏≤‡∏Å (4)', '‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (5)'];
foreach ($subHeaders as $header) {
    $table2->addCell(4000, ['bgColor' => 'FFFFFF', 'gridSpan' => 2, 'valign' => 'center'])
          ->addText($header, ['bold' => true, 'color' => 'FF0000'], ['alignment' => 'center']);
}
$table2->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);
$table2->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);

// Data Rows
$data2 = [
    ['1. ‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏ß‡∏•‡∏≤', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['1.1 ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î', '0', '0', '0', '0', '2', '12.00', '1', '8.00', '7', '70.00', '90.00', '‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à'],
    ['1.2 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£', '-', '-', '-', '-', '2', '12.00', '1', '8.00', '7', '70.00', '90.00', '‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î' ],
    ['2. ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£','', '', '', '', '', '', '', '', '', '', '', ''],
    ['2.1 ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏õ‡πâ‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['2.2 ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÑ‡∏ß‡πâ', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['2.3 ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3. ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['3.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3.2 ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡πá‡∏°‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏†‡∏≤‡∏û', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3.3 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÑ‡∏î‡πâ ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3.4 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏™‡∏∏‡∏à‡∏£‡∏¥‡∏ï‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà ‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏°‡πà‡∏Ç‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô, ‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏ö‡∏ô, ‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏°‡∏¥‡∏ä‡∏≠‡∏ö', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3.5 ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['4. ‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['4.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ö‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['4.2 ‡∏à‡∏∏‡∏î /‡∏ä‡πà‡∏≠‡∏á ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏∞‡∏î‡∏ß‡∏Å', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['4.3 ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏° ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå ‡∏Ø‡∏•‡∏Ø
(‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 4 ‡∏£‡∏≤‡∏¢)
', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['4.4 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
(‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 4 ‡∏£‡∏≤‡∏¢)
', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
['5. ‡∏î‡πâ‡∏≤‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå', '', '', '', '', '', '', '', '', '', '', '', ''],
['5.1 ‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
['5.2 ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≤‡∏Å‡∏• (‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 4 ‡∏£‡∏≤‡∏¢)', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
['5.3 ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
['6. ‡∏ó‡πà‡∏≤‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÉ‡∏î', '', '', '', '', '', '', '', '', '', '', '', ''],
];

foreach ($data2 as $row) {
    $table2->addRow();

    foreach ($row as $index => $value) {
        $cellStyle = ['valign' => 'center'];

        // üü¢ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ "‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô" (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏£‡∏Å) ‡∏≠‡∏¢‡∏π‡πà‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢
        if ($index == 0) {
            $cellStyle['alignment'] = 'left';
        } else {
            $cellStyle['alignment'] = 'center'; // üü¢ ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á
        }

        $table2->addCell(2000, $cellStyle)->addText($value, [], ['alignment' => $cellStyle['alignment']]);
    }
}


// Section 3: ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
$section3 = $phpWord->addSection([
    'orientation' => 'portrait',
]);

$section3->addText(
    "‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3 ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£",
    ['bold' => true, 'size' => 14],
    ['alignment' => 'left']
);


$phpWord->addTableStyle('DissatisfactionTable', $styleTable);
$table3 = $section3->addTable('DissatisfactionTable');

// Table Headers
$table3->addRow();
$table3->addCell(6000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô", ['bold' => true], ['alignment' => 'center']);
$table3->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô(‡∏Ñ‡∏ô)", ['bold' => true], ['alignment' => 'center']);
$table3->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞", ['bold' => true], ['alignment' => 'center']);

// Data Rows
$data3 = [
    ["1. ‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ó‡∏∏‡∏Å‡∏î‡πâ‡∏≤‡∏ô", "11", "61.11"],
    ["2. ‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à", "7", "38.89"],
];

foreach ($data3 as $row) {
    $table3->addRow();
    
    // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏£‡∏Å (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à/‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à)
    $table3->addCell(6000, ['valign' => 'center'])->addText($row[0], [], ['alignment' => 'left']);
    
    // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô) - ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á
    $table3->addCell(2000, ['valign' => 'center'])->addText($row[1], ['bold' => true, 'color' => ($row[0] == "1. ‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ó‡∏∏‡∏Å‡∏î‡πâ‡∏≤‡∏ô" ? 'FF0000' : '000000')], ['alignment' => 'center']);
    
    // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏° (‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞) - ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á
    $table3->addCell(2000, ['valign' => 'center'])->addText($row[2], ['bold' => true, 'color' => ($row[0] == "1. ‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ó‡∏∏‡∏Å‡∏î‡πâ‡∏≤‡∏ô" ? 'FF0000' : '000000')], ['alignment' => 'center']);
}

// Add spacing
$section3->addTextBreak(1);

// Table 2: ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
$table4 = $section3->addTable('DissatisfactionTable');
$table4->addRow();
$table4->addCell(6000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô(‡∏Ñ‡∏ô)", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞", ['bold' => true], ['alignment' => 'center']);

// Data Rows
$data4 = [
    ["1. ‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "2", "28.57"],
    ["2. ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "3", "42.86"],
    ["3. ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "6", "85.71"],
    ["4. ‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å", "5", "71.43"],
    ["5. ‡∏î‡πâ‡∏≤‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå", "5", "71.43"],
];



foreach ($data4 as $row){
    $table4->addRow();

    // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏£‡∏Å
    $table4->addCell(6000, ['valign' => 'center'])->addText($row[0], [], ['alignment' => 'left']);

    //‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏≠‡∏á
    $table4->addCell(2000, ['valign' => 'center'])->addText($row[1], ['bold'=>'true'], ['alignment' => 'center']);

    //‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏≤‡∏°
    $table4->addCell(2000, ['valign' => 'center'])->addText($row[2], ['bold'=>'true'], ['alignment' => 'center']);
}


// section 4 : ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏Å‡∏¢‡∏ó.
$section4 = $phpWord->addSection([
    'orientation' => 'portrait',
]);

$section4->addText(
    "‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏Å‡∏¢‡∏ó.",
    ['bold' => true, 'size' => 14],
    ['alignment' => 'left']
);

// Table Style
$styleTable4 = [
    'borderSize' => 6,
    'cellMargin' => 80,
    'alignment' => 'center'
];

$phpWord->addTableStyle('CommitmentTable', $styleTable4);
$table4 = $section4->addTable('CommitmentTable');

// Table Headers
$table4->addRow();
$table4->addCell(5000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô/‡∏î‡πâ‡∏≤‡∏ô", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(4000, ['bgColor' => 'D9D9D9', 'gridSpan' => 2, 'valign' => 'center'])->addText("‡∏°‡∏≤‡∏Å", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(4000, ['bgColor' => 'D9D9D9', 'gridSpan' => 2, 'valign' => 'center'])->addText("‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(4000, ['bgColor' => 'D9D9D9', 'gridSpan' => 2, 'valign' => 'center'])->addText("‡∏ô‡πâ‡∏≠‡∏¢", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("‡πÅ‡∏õ‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°", ['bold' => true], ['alignment' => 'center']);

// Sub Headers Row
$table4->addRow();
$table4->addCell(5000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);
for ($i = 0; $i < 3; $i++) {
    $table4->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center'])->addText("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô", ['bold' => true], ['alignment' => 'center']);
    $table4->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center'])->addText("‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞", ['bold' => true], ['alignment' => 'center']);
}
$table4->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);
$table4->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);

// Data Rows
$data4 = [
    ["1. ‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏ô‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó.", "28", "77.51", "6", "16.61", "-", "-", "94.12", "‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏°‡∏≤‡∏Å"],
    ["2. ‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó. ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á", "25", "69.20", "9", "24.91", "-", "-", "91.18", "‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏°‡∏≤‡∏Å"],
    ["3. ‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó. ‡∏ï‡πà‡∏≠‡πÑ‡∏õ", "28", "77.51", "6", "16.61", "-", "-", "94.12", "‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏°‡∏≤‡∏Å"],
    ["4. ‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó. ‡πÅ‡∏Å‡πà‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô", "23", "60.35", "11", "28.86", "-", "-", "89.22", "‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏°‡∏≤‡∏Å"],
    ["5. ‡∏ó‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏≠‡∏á ‡∏Å‡∏¢‡∏ó.", "25", "65.60", "9", "23.62", "-", "-", "91.18", "‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏°‡∏≤‡∏Å"],
];

foreach ($data4 as $row) {
    $table4->addRow();
    $table4->addCell(5000, ['valign' => 'center'])->addText($row[0], [], ['alignment' => 'left']);
    for ($i = 1; $i <= 6; $i++) {
        $table4->addCell(2000, ['valign' => 'center'])->addText($row[$i], [], ['alignment' => 'center']);
    }
    $table4->addCell(2000, ['valign' => 'center'])->addText($row[7], [], ['alignment' => 'center']);
    $table4->addCell(2000, ['valign' => 'center'])->addText($row[8], [], ['alignment' => 'center']);
}

// Save File
$filename = 'survey_report.docx';
header('Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document');
header('Content-Disposition: attachment;filename="' . $filename . '"');
header('Cache-Control: max-age=0');

$objWriter = \PhpOffice\PhpWord\IOFactory::createWriter($phpWord, 'Word2007');
$objWriter->save('php://output');
exit;
