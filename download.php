<?php
require_once 'vendor/autoload.php';

use PhpOffice\PhpWord\PhpWord;
use PhpOffice\PhpWord\Style\Table;
use PhpOffice\PhpWord\Style\Cell;
use PhpOffice\PhpWord\Style\Font;
use PhpOffice\PhpWord\Style\Paragraph;

// Create a new PHPWord Object
$phpWord = new PhpWord();
$phpWord->setDefaultFontName('TH SarabunPSK');
$phpWord->setDefaultFontSize(12);

// Section 1: à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹ˆà¸§à¹„à¸›à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¸•à¸­à¸šà¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡
$section1 = $phpWord->addSection();

// Title
$section1->addText(
    "à¸ªà¸£à¸¸à¸›à¸œà¸¥à¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡à¸„à¸§à¸²à¸¡à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸„à¸²à¸”à¸«à¸§à¸±à¸‡à¸•à¹ˆà¸­à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸‚à¸­à¸‡ à¸à¸¢à¸—.",
    ['bold' => true, 'size' => 14],
    ['alignment' => 'center']
);

$section1->addText("à¸•à¸­à¸™à¸—à¸µà¹ˆ 1 à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹ˆà¸§à¹„à¸›à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¸•à¸­à¸šà¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡", ['bold' => true, 'size' => 12]);

// Table Style
$styleTable = [
    'borderSize' => 6, 
    'borderColor' => '000000',
    'cellMargin' => 80,
    'alignment' => 'center'
];
$phpWord->addTableStyle('SurveyTable', $styleTable);
$table = $section1->addTable('SurveyTable');

// Table Headers
$table->addRow();
$table->addCell(6000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹ˆà¸§à¹„à¸›", ['bold' => true], ['alignment' => 'center']);
$table->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸ˆà¸³à¸™à¸§à¸™(à¸„à¸™)", ['bold' => true], ['alignment' => 'center']);
$table->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸£à¹‰à¸­à¸¢à¸¥à¸°", ['bold' => true], ['alignment' => 'center']);

// Data Rows
$data1 = [
    [['1. à¹€à¸žà¸¨','    1.1 à¸Šà¸²à¸¢', '    1.2 à¸«à¸à¸´à¸‡'], ['','6', '4'], ['','60.00', '40.00']],
    [['2. à¸­à¸²à¸¢à¸¸','    2.1 21 - 40 à¸›à¸µ', '    2.2 41 - 60 à¸›à¸µ', '    2.3 60 à¸›à¸µà¸‚à¸¶à¹‰à¸™à¹„à¸›'], ['','3', '3', '4'], ['','30.00', '30.00', '40.00']],
    [['3. à¸£à¸°à¸”à¸±à¸šà¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸ªà¸¹à¸‡à¸ªà¸¸à¸”','    3.1 à¸›à¸£à¸´à¸à¸à¸²à¸•à¸£à¸µ', '    3.2 à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²à¸›à¸£à¸´à¸à¸à¸²à¸•à¸£à¸µ'], ['','5', '5'], ['','50.00', '50.00']],
    [['4. à¸ªà¸–à¸²à¸™à¸ à¸²à¸žà¸‚à¸­à¸‡à¸œà¸¹à¹‰à¸£à¸±à¸šà¸šà¸£à¸´à¸à¸²à¸£', '    4.1 à¹€à¸à¸©à¸•à¸£à¸à¸£','    4.2 à¸ªà¸–à¸²à¸šà¸±à¸™à¹€à¸à¸©à¸•à¸£à¸à¸£','    4.3 à¸œà¸¹à¹‰à¸›à¸£à¸°à¸à¸­à¸šà¸à¸²à¸£/à¸šà¸£à¸´à¸©à¸±à¸—','    4.4 à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™à¸œà¸¹à¹‰à¸£à¸±à¸šà¸šà¸£à¸´à¸à¸²à¸£','    4.5 à¸¡à¸«à¸²à¸§à¸´à¸—à¸¢à¸²à¸¥à¸±à¸¢','    4.6 à¸­à¸·à¹ˆà¸™à¹†'],['','2','2','2','2','1','1'],['','20.00','20.00','20.00','20.00','10.00','10.00']],
    [['5. à¸ˆà¸³à¸™à¸§à¸™à¸„à¸£à¸±à¹‰à¸‡à¸—à¸µà¹ˆà¹€à¸„à¸¢à¹ƒà¸Šà¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹à¸¥à¸°à¸‹à¸·à¹‰à¸­à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸‚à¸­à¸‡ à¸à¸¢à¸—.','    5.1 1 à¸„à¸£à¸±à¹‰à¸‡','    5.2 2 à¸„à¸£à¸±à¹‰à¸‡','    5.3 3 à¸„à¸£à¸±à¹‰à¸‡','    5.4 4 à¸„à¸£à¸±à¹‰à¸‡','    5.5 à¸­à¸·à¹ˆà¸™à¹†'],['','2','2','2','2','2'],['','20.00','20.00','20.00','20.00','20.00']],
    [['6. à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¸—à¸µà¹ˆà¸—à¹ˆà¸²à¸™à¹€à¸›à¹‡à¸™à¸¥à¸¹à¸à¸„à¹‰à¸²à¸‚à¸­à¸‡ à¸à¸¢à¸—.','    6.1 1 à¸›à¸µ','    6.2 2 à¸›à¸µ','    6.3 3 à¸›à¸µ','    6.4 à¸¡à¸²à¸à¸à¸§à¹ˆà¸² 4 à¸›à¸µ','    6.5 à¸­à¸·à¹ˆà¸™à¹†'],['','2','2','2','2','2'],['','20.00','20.00','20.00','20.00','20.00']],
    [['7. à¸šà¸£à¸´à¸à¸²à¸£à¸«à¸£à¸·à¸­à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸‚à¸­à¸‡ à¸à¸¢à¸—.à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸šà¸£à¸´à¸à¸²à¸£ (à¸•à¸­à¸šà¹„à¸”à¹‰à¸¡à¸²à¸à¸à¸§à¹ˆà¸² 1 à¸‚à¹‰à¸­)','    7.1 à¹ƒà¸Šà¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸‹à¸·à¹‰à¸­-à¸‚à¸²à¸¢à¸¢à¸²à¸‡à¸œà¹ˆà¸²à¸™à¸•à¸¥à¸²à¸” à¸à¸¢à¸—.','    7.2 à¸‹à¸·à¹‰à¸­à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸¢à¸²à¸‡à¹à¸›à¸£à¸£à¸¹à¸›à¸‚à¸±à¹‰à¸™à¸•à¹‰à¸™à¸ˆà¸²à¸ à¸à¸¢à¸—.','    7.3 à¸‹à¸·à¹‰à¸­à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸¢à¸²à¸‡à¸ˆà¸²à¸ à¸à¸¢à¸—.','    7.4 à¸™à¸³à¸‡à¸²à¸™à¸§à¸´à¸ˆà¸±à¸¢à¸‚à¸­à¸‡ à¸à¸¢à¸—. à¹„à¸›à¹ƒà¸Šà¹‰à¸›à¸£à¸°à¹‚à¸¢à¸Šà¸™à¹Œ','    7.4 à¸™à¸³à¸‡à¸²à¸™à¸§à¸´à¸ˆà¸±à¸¢à¸‚à¸­à¸‡ à¸à¸¢à¸—. à¹„à¸›à¹ƒà¸Šà¹‰à¸›à¸£à¸°à¹‚à¸¢à¸Šà¸™à¹Œ','    7.5 à¸­à¸·à¹ˆà¸™à¹†'],
    ['','2','2','2','2','2'],['','20.00','20.00','20.00','20.00','20.00']]
];

foreach ($data1 as $row) {
    $table->addRow();

    // ðŸŸ¢ à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¹à¸£à¸ (à¸›à¸£à¸°à¹€à¸”à¹‡à¸™) à¸ˆà¸±à¸”à¸Šà¸´à¸”à¸‹à¹‰à¸²à¸¢
    $cell1 = $table->addCell(6000, ['valign' => 'top']);
    $textRun1 = $cell1->addTextRun();
    foreach ($row[0] as $line) {
        $textRun1->addText($line, [], ['alignment' => 'left']);
        $textRun1->addTextBreak();
    }

    // ðŸŸ¢ à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¸ªà¸­à¸‡ (à¸ˆà¸³à¸™à¸§à¸™) à¸ˆà¸±à¸”à¸à¸¶à¹ˆà¸‡à¸à¸¥à¸²à¸‡
    $cell2 = $table->addCell(2000, ['valign' => 'top']);
    $textRun2 = $cell2->addTextRun(['alignment' => 'center']);
    foreach ($row[1] as $line) {
        $textRun2->addText($line, [], ['alignment' => 'center']);
        $textRun2->addTextBreak();
    }

    // ðŸŸ¢ à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¸ªà¸²à¸¡ (à¸£à¹‰à¸­à¸¢à¸¥à¸°) à¸ˆà¸±à¸”à¸à¸¶à¹ˆà¸‡à¸à¸¥à¸²à¸‡
    $cell3 = $table->addCell(2000, ['valign' => 'top']);
    $textRun3 = $cell3->addTextRun(['alignment' => 'center']);
    foreach ($row[2] as $line) {
        $textRun3->addText($line, [], ['alignment' => 'center']);
        $textRun3->addTextBreak();
    }
}


// Section 2: à¸ªà¸£à¸¸à¸›à¸œà¸¥à¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡à¸„à¸§à¸²à¸¡à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ
$section2 = $phpWord->addSection([
    'orientation' => 'landscape',
]);

$section2->addText(
    "à¸•à¸­à¸™à¸—à¸µà¹ˆ2 à¸ªà¸£à¸¸à¸›à¸œà¸¥à¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡à¸„à¸§à¸²à¸¡à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ / à¹„à¸¡à¹ˆà¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆà¸•à¹ˆà¸­à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£",
    ['bold' => true, 'size' => 14],
    ['alignment' => 'left']
);

// Table Style
$phpWord->addTableStyle('SurveyTable2', $styleTable);
$table2 = $section2->addTable('SurveyTable2');

// Table Headers
$table2->addRow();
$table2->addCell(4000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])
       ->addText("à¸›à¸£à¸°à¹€à¸”à¹‡à¸™", ['bold' => true], ['alignment' => 'center']);
$table2->addCell(8000, ['bgColor' => 'D9D9D9', 'gridSpan' => 10, 'valign' => 'center'])
       ->addText("à¸„à¸§à¸²à¸¡à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ", ['bold' => true], ['alignment' => 'center']);
$table2->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])
       ->addText("à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ", ['bold' => true], ['alignment' => 'center']);
$table2->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])
       ->addText("à¹à¸›à¸¥à¸„à¸§à¸²à¸¡", ['bold' => true], ['alignment' => 'center']);

// Sub Headers Row 1
$table2->addRow();
$table2->addCell(4000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);
$subHeaders = ['à¸™à¹‰à¸­à¸¢à¸¡à¸²à¸ (1)', 'à¸™à¹‰à¸­à¸¢ (2)', 'à¸›à¸²à¸™à¸à¸¥à¸²à¸‡ (3)', 'à¸¡à¸²à¸ (4)', 'à¸¡à¸²à¸à¸—à¸µà¹ˆà¸ªà¸¸à¸” (5)'];
foreach ($subHeaders as $header) {
    $table2->addCell(4000, ['bgColor' => 'FFFFFF', 'gridSpan' => 2, 'valign' => 'center'])
          ->addText($header, ['bold' => true, 'color' => 'FF0000'], ['alignment' => 'center']);
}
$table2->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);
$table2->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);

// Data Rows
$data2 = [
    ['1. à¸”à¹‰à¸²à¸™à¹€à¸§à¸¥à¸²', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['1.1 à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹€à¸›à¹‡à¸™à¹„à¸›à¸•à¸²à¸¡à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”', '0', '0', '0', '0', '2', '12.00', '1', '8.00', '7', '70.00', '90.00', 'à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ'],
    ['1.2 à¸„à¸§à¸²à¸¡à¸£à¸§à¸”à¹€à¸£à¹‡à¸§à¹ƒà¸™à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£', '-', '-', '-', '-', '2', '12.00', '1', '8.00', '7', '70.00', '90.00', 'à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆà¸¡à¸²à¸à¸—à¸µà¹ˆà¸ªà¸¸à¸”' ],
    ['2. à¸”à¹‰à¸²à¸™à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£','', '', '', '', '', '', '', '', '', '', '', ''],
    ['2.1 à¸à¸²à¸£à¸•à¸´à¸”à¸›à¹‰à¸²à¸¢à¸›à¸£à¸°à¸à¸²à¸¨à¸«à¸£à¸·à¸­à¹à¸ˆà¹‰à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¹à¸¥à¸°à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¹ƒà¸™à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['2.2 à¸à¸²à¸£à¸ˆà¸±à¸”à¸¥à¸³à¸”à¸±à¸šà¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸•à¸²à¸¡à¸—à¸µà¹ˆà¸›à¸£à¸°à¸à¸²à¸¨à¹„à¸§à¹‰', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['2.3 à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸•à¸²à¸¡à¸¥à¸³à¸”à¸±à¸šà¸à¹ˆà¸­à¸™à¸«à¸¥à¸±à¸‡ à¹€à¸Šà¹ˆà¸™ à¸¡à¸²à¸à¹ˆà¸­à¸™à¸•à¹‰à¸­à¸‡à¹„à¸”à¹‰à¸£à¸±à¸šà¸šà¸£à¸´à¸à¸²à¸£à¸à¹ˆà¸­à¸™', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3. à¸”à¹‰à¸²à¸™à¸šà¸¸à¸„à¸¥à¸²à¸à¸£à¸—à¸µà¹ˆà¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['3.1 à¸„à¸§à¸²à¸¡à¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡à¹ƒà¸™à¸à¸²à¸£à¹à¸•à¹ˆà¸‡à¸à¸²à¸¢à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3.2 à¸„à¸§à¸²à¸¡à¹€à¸•à¹‡à¸¡à¹ƒà¸ˆà¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸žà¸£à¹‰à¸­à¸¡à¹ƒà¸™à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸­à¸¢à¹ˆà¸²à¸‡à¸ªà¸¸à¸ à¸²à¸ž', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3.3 à¸„à¸§à¸²à¸¡à¸£à¸¹à¹‰à¸„à¸§à¸²à¸¡à¸ªà¸²à¸¡à¸²à¸£à¸–à¹ƒà¸™à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£ à¹€à¸Šà¹ˆà¸™ à¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸­à¸šà¸„à¸³à¸–à¸²à¸¡à¸Šà¸µà¹‰à¹à¸ˆà¸‡à¸‚à¹‰à¸­à¸ªà¸‡à¸ªà¸±à¸¢à¹ƒà¸«à¹‰à¸„à¸³à¹à¸™à¸°à¸™à¸³à¹„à¸”à¹‰ à¹€à¸›à¹‡à¸™à¸•à¹‰à¸™', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3.4 à¸„à¸§à¸²à¸¡à¸‹à¸·à¹ˆà¸­à¸ªà¸±à¸•à¸¢à¹Œà¸ªà¸¸à¸ˆà¸£à¸´à¸•à¹ƒà¸™à¸à¸²à¸£à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ à¹€à¸Šà¹ˆà¸™ à¹„à¸¡à¹ˆà¸‚à¸­à¸ªà¸´à¹ˆà¸‡à¸•à¸­à¸šà¹à¸—à¸™, à¹„à¸¡à¹ˆà¸£à¸±à¸šà¸ªà¸´à¸™à¸šà¸™, à¹„à¸¡à¹ˆà¸«à¸²à¸œà¸¥à¸›à¸£à¸°à¹‚à¸¢à¸Šà¸™à¹Œà¹ƒà¸™à¸—à¸²à¸‡à¸¡à¸´à¸Šà¸­à¸š', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['3.5 à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹€à¸«à¸¡à¸·à¸­à¸™à¸à¸±à¸™à¸—à¸¸à¸à¸£à¸²à¸¢à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¹€à¸¥à¸·à¸­à¸à¸›à¸à¸´à¸šà¸±à¸•', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['4. à¸”à¹‰à¸²à¸™à¸ªà¸´à¹ˆà¸‡à¸­à¸³à¸™à¸§à¸¢à¸„à¸§à¸²à¸¡à¸ªà¸°à¸”à¸§à¸', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['4.1 à¸„à¸§à¸²à¸¡à¸Šà¸±à¸”à¹€à¸ˆà¸™à¸‚à¸­à¸‡à¸›à¹‰à¸²à¸¢à¸ªà¸±à¸à¸¥à¸±à¸à¸©à¸“à¹Œà¸›à¸£à¸°à¸Šà¸²à¸ªà¸±à¸¡à¸žà¸±à¸™à¸˜à¹Œà¸šà¸­à¸à¸ˆà¸¸à¸”à¸šà¸£à¸´à¸à¸²à¸£', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['4.2 à¸ˆà¸¸à¸” /à¸Šà¹ˆà¸­à¸‡ à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸¡à¸µà¸„à¸§à¸²à¸¡à¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡à¹à¸¥à¸°à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹„à¸”à¹‰à¸ªà¸°à¸”à¸§à¸', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['4.3 à¸„à¸§à¸²à¸¡à¹€à¸žà¸µà¸¢à¸‡à¸žà¸­à¸‚à¸­à¸‡à¸ªà¸´à¹ˆà¸‡à¸­à¸³à¸™à¸§à¸¢à¸„à¸§à¸²à¸¡à¸ªà¸°à¸”à¸§à¸ à¹€à¸Šà¹ˆà¸™ à¸—à¸µà¹ˆà¸™à¸±à¹ˆà¸‡à¸£à¸­à¸£à¸±à¸šà¸šà¸£à¸´à¸à¸²à¸£ à¸™à¹‰à¸³à¸”à¸·à¹ˆà¸¡ à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸žà¸´à¸¡à¸žà¹Œ à¸¯à¸¥à¸¯
(à¹„à¸¡à¹ˆà¸™à¸±à¸šà¸œà¸¹à¹‰à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸‚à¸™à¸ªà¹ˆà¸‡ à¸ˆà¸³à¸™à¸§à¸™ 4 à¸£à¸²à¸¢)
', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
    ['4.4 à¸„à¸§à¸²à¸¡à¸ªà¸°à¸­à¸²à¸”à¸‚à¸­à¸‡à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£
(à¹„à¸¡à¹ˆà¸™à¸±à¸šà¸œà¸¹à¹‰à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸‚à¸™à¸ªà¹ˆà¸‡ à¸ˆà¸³à¸™à¸§à¸™ 4 à¸£à¸²à¸¢)
', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
['5. à¸”à¹‰à¸²à¸™à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œ', '', '', '', '', '', '', '', '', '', '', '', ''],
['5.1 à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸¡à¸µà¸„à¸¸à¸“à¸ à¸²à¸žà¸”à¸µà¹à¸¥à¸°à¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡à¸•à¹ˆà¸­à¸£à¸²à¸„à¸²', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
['5.2 à¸„à¸¸à¸“à¸ªà¸¡à¸šà¸±à¸•à¸´à¸‚à¸­à¸‡à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¹€à¸›à¹‡à¸™à¹„à¸›à¸•à¸²à¸¡à¸¡à¸²à¸•à¸£à¸à¸²à¸™à¸ªà¸²à¸à¸¥ (à¹„à¸¡à¹ˆà¸™à¸±à¸šà¸œà¸¹à¹‰à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸‚à¸™à¸ªà¹ˆà¸‡ à¸ˆà¸³à¸™à¸§à¸™ 4 à¸£à¸²à¸¢)', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
['5.3 à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸¡à¸µà¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹à¸¥à¸°à¸„à¸³à¹à¸™à¸°à¸™à¸³à¸«à¸¥à¸±à¸‡à¸à¸²à¸£à¸‚à¸²à¸¢', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-'],
['6. à¸—à¹ˆà¸²à¸™à¸¡à¸µà¸„à¸§à¸²à¸¡à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆà¸•à¹ˆà¸­à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹ƒà¸™à¸ à¸²à¸žà¸£à¸§à¸¡à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸£à¸°à¸”à¸±à¸šà¹ƒà¸”', '', '', '', '', '', '', '', '', '', '', '', ''],
];

foreach ($data2 as $row) {
    $table2->addRow();

    foreach ($row as $index => $value) {
        $cellStyle = ['valign' => 'center'];

        // ðŸŸ¢ à¸à¸³à¸«à¸™à¸”à¹ƒà¸«à¹‰ "à¸›à¸£à¸°à¹€à¸”à¹‡à¸™" (à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¹à¸£à¸) à¸­à¸¢à¸¹à¹ˆà¸Šà¸´à¸”à¸‹à¹‰à¸²à¸¢
        if ($index == 0) {
            $cellStyle['alignment'] = 'left';
        } else {
            $cellStyle['alignment'] = 'center'; // ðŸŸ¢ à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¸—à¸µà¹ˆà¹€à¸«à¸¥à¸·à¸­à¸­à¸¢à¸¹à¹ˆà¸•à¸£à¸‡à¸à¸¥à¸²à¸‡
        }

        $table2->addCell(2000, $cellStyle)->addText($value, [], ['alignment' => $cellStyle['alignment']]);
    }
}


// Section 3: à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆà¸•à¹ˆà¸­à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£
$section3 = $phpWord->addSection([
    'orientation' => 'portrait',
]);

$section3->addText(
    "à¸•à¸­à¸™à¸—à¸µà¹ˆ 3 à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆà¸•à¹ˆà¸­à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£",
    ['bold' => true, 'size' => 14],
    ['alignment' => 'left']
);


$phpWord->addTableStyle('DissatisfactionTable', $styleTable);
$table3 = $section3->addTable('DissatisfactionTable');

// Table Headers
$table3->addRow();
$table3->addCell(6000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸ªà¸£à¸¸à¸›à¸œà¸¥à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™", ['bold' => true], ['alignment' => 'center']);
$table3->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸ˆà¸³à¸™à¸§à¸™(à¸„à¸™)", ['bold' => true], ['alignment' => 'center']);
$table3->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸£à¹‰à¸­à¸¢à¸¥à¸°", ['bold' => true], ['alignment' => 'center']);

// Data Rows
$data3 = [
    ["1. à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆà¸—à¸¸à¸à¸”à¹‰à¸²à¸™", "11", "61.11"],
    ["2. à¹„à¸¡à¹ˆà¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ", "7", "38.89"],
];

foreach ($data3 as $row) {
    $table3->addRow();
    
    // à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¹à¸£à¸ (à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡ à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ/à¹„à¸¡à¹ˆà¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ)
    $table3->addCell(6000, ['valign' => 'center'])->addText($row[0], [], ['alignment' => 'left']);
    
    // à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¸—à¸µà¹ˆà¸ªà¸­à¸‡ (à¸ˆà¸³à¸™à¸§à¸™à¸„à¸™) - à¸ˆà¸±à¸”à¹ƒà¸«à¹‰à¸­à¸¢à¸¹à¹ˆà¸à¸¶à¹ˆà¸‡à¸à¸¥à¸²à¸‡
    $table3->addCell(2000, ['valign' => 'center'])->addText($row[1], ['bold' => true, 'color' => ($row[0] == "1. à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆà¸—à¸¸à¸à¸”à¹‰à¸²à¸™" ? 'FF0000' : '000000')], ['alignment' => 'center']);
    
    // à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¸—à¸µà¹ˆà¸ªà¸²à¸¡ (à¸£à¹‰à¸­à¸¢à¸¥à¸°) - à¸ˆà¸±à¸”à¹ƒà¸«à¹‰à¸­à¸¢à¸¹à¹ˆà¸à¸¶à¹ˆà¸‡à¸à¸¥à¸²à¸‡
    $table3->addCell(2000, ['valign' => 'center'])->addText($row[2], ['bold' => true, 'color' => ($row[0] == "1. à¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆà¸—à¸¸à¸à¸”à¹‰à¸²à¸™" ? 'FF0000' : '000000')], ['alignment' => 'center']);
}

// Add spacing
$section3->addTextBreak(1);

// Table 2: à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ
$table4 = $section3->addTable('DissatisfactionTable');
$table4->addRow();
$table4->addCell(6000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸ªà¸£à¸¸à¸›à¸œà¸¥à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸žà¸¶à¸‡à¸žà¸­à¹ƒà¸ˆ", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸ˆà¸³à¸™à¸§à¸™(à¸„à¸™)", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸£à¹‰à¸­à¸¢à¸¥à¸°", ['bold' => true], ['alignment' => 'center']);

// Data Rows
$data4 = [
    ["1. à¸”à¹‰à¸²à¸™à¹€à¸§à¸¥à¸²à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£", "2", "28.57"],
    ["2. à¸”à¹‰à¸²à¸™à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£", "3", "42.86"],
    ["3. à¸”à¹‰à¸²à¸™à¸šà¸¸à¸„à¸¥à¸²à¸à¸£à¸—à¸µà¹ˆà¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£", "6", "85.71"],
    ["4. à¸”à¹‰à¸²à¸™à¸ªà¸´à¹ˆà¸‡à¸­à¸³à¸™à¸§à¸¢à¸„à¸§à¸²à¸¡à¸ªà¸°à¸”à¸§à¸", "5", "71.43"],
    ["5. à¸”à¹‰à¸²à¸™à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œ", "5", "71.43"],
];



foreach ($data4 as $row){
    $table4->addRow();

    // à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¹à¸£à¸
    $table4->addCell(6000, ['valign' => 'center'])->addText($row[0], [], ['alignment' => 'left']);

    //à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¸ªà¸­à¸‡
    $table4->addCell(2000, ['valign' => 'center'])->addText($row[1], ['bold'=>'true'], ['alignment' => 'center']);

    //à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¸ªà¸²à¸¡
    $table4->addCell(2000, ['valign' => 'center'])->addText($row[2], ['bold'=>'true'], ['alignment' => 'center']);
}


// section 4 : à¸„à¸§à¸²à¸¡à¸œà¸¹à¸à¸žà¸±à¸™à¸•à¹ˆà¸­à¸à¸¢à¸—.
$section4 = $phpWord->addSection([
    'orientation' => 'portrait',
]);

$section4->addText(
    "à¸•à¸­à¸™à¸—à¸µà¹ˆ 4 à¸„à¸§à¸²à¸¡à¸œà¸¹à¸à¸žà¸±à¸™à¸•à¹ˆà¸­à¸à¸¢à¸—.",
    ['bold' => true, 'size' => 14],
    ['alignment' => 'left']
);

// Table Style
$styleTable4 = [
    'borderSize' => 6,
    'cellMargin' => 80,
    'alignment' => 'center'
];

$phpWord->addTableStyle('CommitmentTable', $styleTable4);
$table4 = $section4->addTable('CommitmentTable');

// Table Headers
$table4->addRow();
$table4->addCell(5000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸›à¸£à¸°à¹€à¸”à¹‡à¸™/à¸”à¹‰à¸²à¸™", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(4000, ['bgColor' => 'D9D9D9', 'gridSpan' => 2, 'valign' => 'center'])->addText("à¸¡à¸²à¸", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(4000, ['bgColor' => 'D9D9D9', 'gridSpan' => 2, 'valign' => 'center'])->addText("à¸›à¸²à¸™à¸à¸¥à¸²à¸‡", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(4000, ['bgColor' => 'D9D9D9', 'gridSpan' => 2, 'valign' => 'center'])->addText("à¸™à¹‰à¸­à¸¢", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸œà¸¹à¸à¸žà¸±à¸™", ['bold' => true], ['alignment' => 'center']);
$table4->addCell(2000, ['bgColor' => 'D9D9D9', 'valign' => 'center'])->addText("à¹à¸›à¸¥à¸„à¸§à¸²à¸¡", ['bold' => true], ['alignment' => 'center']);

// Sub Headers Row
$table4->addRow();
$table4->addCell(5000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);
for ($i = 0; $i < 3; $i++) {
    $table4->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center'])->addText("à¸ˆà¸³à¸™à¸§à¸™", ['bold' => true], ['alignment' => 'center']);
    $table4->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center'])->addText("à¸£à¹‰à¸­à¸¢à¸¥à¸°", ['bold' => true], ['alignment' => 'center']);
}
$table4->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);
$table4->addCell(2000, ['bgColor' => 'FFFFFF', 'valign' => 'center']);

// Data Rows
$data4 = [
    ["1. à¸—à¹ˆà¸²à¸™à¸ªà¸™à¹ƒà¸ˆà¹à¸¥à¸°à¸«à¸²à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹à¸¥à¸°à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸‚à¸­à¸‡ à¸à¸¢à¸—.", "28", "77.51", "6", "16.61", "-", "-", "94.12", "à¸œà¸¹à¸à¸žà¸±à¸™à¸¡à¸²à¸"],
    ["2. à¸—à¹ˆà¸²à¸™à¸ˆà¸°à¸à¸¥à¸±à¸šà¸¡à¸²à¹ƒà¸Šà¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹à¸¥à¸°à¸‹à¸·à¹‰à¸­à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸‚à¸­à¸‡ à¸à¸¢à¸—. à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡", "25", "69.20", "9", "24.91", "-", "-", "91.18", "à¸œà¸¹à¸à¸žà¸±à¸™à¸¡à¸²à¸"],
    ["3. à¸—à¹ˆà¸²à¸™à¸ˆà¸°à¹€à¸›à¹‡à¸™à¸¥à¸¹à¸à¸„à¹‰à¸²à¸‚à¸­à¸‡ à¸à¸¢à¸—. à¸•à¹ˆà¸­à¹„à¸›", "28", "77.51", "6", "16.61", "-", "-", "94.12", "à¸œà¸¹à¸à¸žà¸±à¸™à¸¡à¸²à¸"],
    ["4. à¸—à¹ˆà¸²à¸™à¸ˆà¸°à¹à¸™à¸°à¸™à¸³à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹à¸¥à¸°à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸‚à¸­à¸‡ à¸à¸¢à¸—. à¹à¸à¹ˆà¸œà¸¹à¹‰à¸­à¸·à¹ˆà¸™", "23", "60.35", "11", "28.86", "-", "-", "89.22", "à¸œà¸¹à¸à¸žà¸±à¸™à¸¡à¸²à¸"],
    ["5. à¸—à¹ˆà¸²à¸™à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸£à¸±à¸šà¸£à¸¹à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¹ˆà¸²à¸§à¸ªà¸²à¸£à¸‚à¸­à¸‡à¸à¸²à¸£à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¹à¸¥à¸°à¸œà¸¥à¸´à¸•à¸ à¸±à¸“à¸‘à¹Œà¸‚à¸­à¸‡ à¸à¸¢à¸—.", "25", "65.60", "9", "23.62", "-", "-", "91.18", "à¸œà¸¹à¸à¸žà¸±à¸™à¸¡à¸²à¸"],
];

foreach ($data4 as $row) {
    $table4->addRow();
    $table4->addCell(5000, ['valign' => 'center'])->addText($row[0], [], ['alignment' => 'left']);
    for ($i = 1; $i <= 6; $i++) {
        $table4->addCell(2000, ['valign' => 'center'])->addText($row[$i], [], ['alignment' => 'center']);
    }
    $table4->addCell(2000, ['valign' => 'center'])->addText($row[7], [], ['alignment' => 'center']);
    $table4->addCell(2000, ['valign' => 'center'])->addText($row[8], [], ['alignment' => 'center']);
}

// Save File
$filename = 'survey_report.docx';
header('Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document');
header('Content-Disposition: attachment;filename="' . $filename . '"');
header('Cache-Control: max-age=0');

$objWriter = \PhpOffice\PhpWord\IOFactory::createWriter($phpWord, 'Word2007');
$objWriter->save('php://output');
exit;
